---
import Layout from "@layouts/Layout.astro";
import Container from "@components/Container.astro";

import { getEntry } from "astro:content";

// Fetch bookmarks from content collection (single file "items")
const entry = await getEntry("bookmarks", "items");
const bookmarks = entry?.data.items || [];

// Sort by date (newest first)
const sortedBookmarks = bookmarks.sort(
  (a, b) => new Date(b.date).getTime() - new Date(a.date).getTime(),
);
---

<Layout title="Закладки" description="Интересные ссылки, которые я сохранил">
  <Container>
    <div class="animate">
      <h1 class="mb-8 text-3xl font-semibold text-black dark:text-white">
        Закладки
      </h1>

      <p class="mb-12 text-lg text-gray-600 dark:text-gray-400">
        Ежедневно я получаю новые статьи, видео, эссе и другие материалы в моем
        RSS-ридере. Здесь я делюсь ссылками, которые нашел интересными и
        полезными.
      </p>

      <!-- Bookmarks List -->
      <div class="space-y-1">
        {
          sortedBookmarks.map((bookmark) => (
            <a
              href={bookmark.url}
              target="_blank"
              rel="noopener noreferrer"
              class="group block no-underline"
            >
              <div class="flex items-center justify-between gap-4 rounded px-3 py-2 transition-colors hover:bg-gray-50 dark:hover:bg-gray-800">
                <div class="flex min-w-0 flex-1 items-center gap-3">
                  <h3 class="truncate font-medium text-black transition-colors group-hover:text-blue-600 dark:text-white dark:group-hover:text-blue-400">
                    {bookmark.title}
                  </h3>
                </div>

                <div class="flex-shrink-0 font-medium text-gray-500 dark:text-gray-400">
                  <span class="group-hover:hidden">
                    {new Date(bookmark.date).toLocaleDateString("ru-RU")}
                  </span>
                  <span class="hidden text-blue-600 group-hover:inline dark:text-blue-400">
                    {new URL(bookmark.url).hostname}
                  </span>
                </div>
              </div>
            </a>
          ))
        }
      </div>
    </div>
  </Container>
</Layout>
